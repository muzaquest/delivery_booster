# üöÄ –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ –° –ñ–ò–í–´–ú API

## üìã **–ü–õ–ê–ù –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø**

### **1. –õ–û–ö–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (—Å–Ω–∞—á–∞–ª–∞ –∑–¥–µ—Å—å)**

#### **–®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
export STATS_API_BASE="http://5.187.7.140:3000"
export DATABASE_URL="postgresql://user:password@localhost:5432/analytics"
```

#### **–®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API**
```bash
python test_live_api.py
```

#### **–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î**
```bash
python db/migrate_to_live_api.py
```

#### **–®–∞–≥ 4: –ü–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
python etl/api_client.py "Only Kebab" --source=all --start-date=2025-01-01

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω
python etl/build_views.py --build-views

# –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è ML
python etl/build_views.py --export-csv=/workspace/data/live_dataset.csv
```

#### **–®–∞–≥ 5: –û–±—É—á–µ–Ω–∏–µ ML –Ω–∞ –∂–∏–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
```bash
python ml/training.py --from-db --out=/workspace/ml/artifacts
```

#### **–®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤**
```bash
# –ó–∞–ø—É—Å–∫ API
uvicorn app.main:app --reload &

# –ó–∞–ø—É—Å–∫ Streamlit
streamlit run streamlit_app.py

# –¢–µ—Å—Ç –æ—Ç—á–µ—Ç–∞
curl "http://localhost:8000/report-text?period=2025-01-01_2025-01-31&restaurant_id=11"
```

---

### **2. –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –ù–ê REPLIT**

#### **–®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞ –≤ Replit**
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Python Repl
2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Secrets (Environment)

#### **–®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Secrets –≤ Replit**
```
STATS_API_BASE = http://5.187.7.140:3000
DATABASE_URL = postgresql://user:pass@host:port/db
OPENAI_API_KEY = sk-... (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

#### **–®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
```bash
pip install -r requirements.txt
```

#### **–®–∞–≥ 4: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î**
```bash
python db/migrate_to_live_api.py
```

#### **–®–∞–≥ 5: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```bash
# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π
python etl/api_client.py "Only Kebab" --source=all
python etl/api_client.py "Ika Canggu" --source=all  
python etl/api_client.py "Asai Cafe" --source=all

# –°—Ç—Ä–æ–∏–º –≤–∏—Ç—Ä–∏–Ω—ã
python etl/build_views.py --build-views
```

#### **–®–∞–≥ 6: –û–±—É—á–µ–Ω–∏–µ ML**
```bash
python ml/training.py --from-db --out=/workspace/ml/artifacts
```

#### **–®–∞–≥ 7: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
# API (–≤ —Ñ–æ–Ω–µ)
uvicorn app.main:app --host 0.0.0.0 --port 8000 &

# Streamlit UI
streamlit run streamlit_app.py --server.port=8501 --server.address=0.0.0.0
```

---

## üîÑ **–ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø –û–ë–ù–û–í–õ–ï–ù–ò–ô**

### **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (cron):**
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab Replit
0 6 * * * cd /workspace && python etl/api_client.py "Only Kebab" --source=all
0 6 * * * cd /workspace && python etl/api_client.py "Ika Canggu" --source=all
30 6 * * * cd /workspace && python etl/build_views.py --build-views
```

### **–ê–≤—Ç–æ–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ ML:**
```bash
# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è–º
0 7 * * 0 cd /workspace && python ml/training.py --from-db
```

---

## üéØ **–ß–¢–û –ò–ó–ú–ï–ù–ò–¢–°–Ø –í –û–¢–ß–ï–¢–ê–•**

### **–î–û (—Å—Ç–∞—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):**
```
üî¥ 2025-04-01 (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑)
- –î–∞–Ω–Ω—ã–µ –∏–∑ —Å–Ω–∞–ø—à–æ—Ç–∞ –ë–î
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—à–ª—ã—Ö —Å–æ–±—ã—Ç–∏–π
```

### **–ü–û–°–õ–ï (–∂–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ):**
```
üî¥ 2025-12-15 (–∞–Ω–∞–ª–∏–∑ –≤—á–µ—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è!)
- –°–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API
- –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –≤—á–µ—Ä–∞—à–Ω–µ–≥–æ –ø—Ä–æ–≤–∞–ª–∞
- –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
- ML –∞–Ω–∞–ª–∏–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–µ–Ω–¥–æ–≤
```

### **–†–∞–∑–¥–µ–ª 8 —Å—Ç–∞–Ω–µ—Ç:**
- **–ê–∫—Ç—É–∞–ª—å–Ω—ã–º** ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–Ω–µ–π
- **–¢–æ—á–Ω—ã–º** ‚Äî ML –Ω–∞ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
- **–ü–æ–ª–µ–∑–Ω—ã–º** ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –ø—Ä–æ–±–ª–µ–º
- **–î–µ—Ç–∞–ª—å–Ω—ã–º** ‚Äî —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º —Å –∂–∏–≤—ã–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏

---

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
```bash
# –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã
python test_live_api.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
python etl/api_client.py "Only Kebab" --quality-report

# –¢–µ—Å—Ç –æ—Ç—á–µ—Ç–∞ —Å –∂–∏–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
curl "http://localhost:8000/report-text?period=2025-12-01_2025-12-15&restaurant_id=11"
```

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- –õ–æ–≥–∏ –≤ `/workspace/logs/api_client.log`
- –°—Ç–∞—Ç—É—Å ML jobs –≤ —Ç–∞–±–ª–∏—Ü–µ `ml_jobs`
- –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –≤ view `data_quality_check`

---

## ‚úÖ **–ì–û–¢–û–í–ù–û–°–¢–¨ –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ**

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ –∂–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ!**

1. ‚úÖ **API –∫–ª–∏–µ–Ω—Ç** —Å —Ä–µ—Ç—Ä–∞—è–º–∏ –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é
2. ‚úÖ **PostgreSQL —Å—Ö–µ–º–∞** —Å –≤–∏—Ç—Ä–∏–Ω–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
3. ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ **ML –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å –ë–î
5. ‚úÖ **Streamlit UI** —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
6. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
7. ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ, –∞ –∑–∞—Ç–µ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å –Ω–∞ Replit!**